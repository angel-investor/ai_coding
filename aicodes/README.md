# ğŸ«€ å¿ƒè¡€ç®¡ç–¾ç—…é¢„æµ‹ç³»ç»Ÿ

åŸºäº XGBoost æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ™ºèƒ½å¿ƒè¡€ç®¡ç–¾ç—…é¢„æµ‹ç³»ç»Ÿï¼Œé›†æˆæ•°æ®åˆ†æã€æ¨¡å‹é¢„æµ‹å’Œ AI è¯­éŸ³é—®ç­”åŠŸèƒ½ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# æ–¹å¼ 1: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬
install_dependencies.bat

# æ–¹å¼ 2: ä½¿ç”¨ä¸»èœå•
START.bat
# é€‰æ‹©: 1 (Install Dependencies)
```

### 2. è®­ç»ƒæ¨¡å‹

```bash
# æ–¹å¼ 1: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬
train_model_xgb.bat

# æ–¹å¼ 2: ä½¿ç”¨ä¸»èœå•
START.bat
# é€‰æ‹©: 2 (Train XGBoost Model)
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼ 1: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬
start_predict_server.bat

# æ–¹å¼ 2: ä½¿ç”¨ä¸»èœå•
START.bat
# é€‰æ‹©: 3 (Start Prediction Server)
```

### 4. è®¿é—®ç³»ç»Ÿ

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- **ç³»ç»Ÿé¦–é¡µ**: http://localhost:5000/
- **ç–¾ç—…é¢„æµ‹**: http://localhost:5000/web/predict.html
- **è¯­éŸ³é—®ç­”**: http://localhost:5000/web/qa_audio.html
- **æ•°æ®åˆ†æ**: http://localhost:5000/analysis/report.html

---

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½

### 1. ç–¾ç—…é£é™©é¢„æµ‹ ğŸ”¬

åŸºäº XGBoost æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè¾“å…¥ 11 é¡¹å¥åº·æŒ‡æ ‡ï¼Œå®æ—¶è¯„ä¼°å¿ƒè¡€ç®¡ç–¾ç—…é£é™©ã€‚

**é¢„æµ‹æŒ‡æ ‡**:
- å¹´é¾„ã€æ€§åˆ«ã€èº«é«˜ã€ä½“é‡
- æ”¶ç¼©å‹ã€èˆ’å¼ å‹
- èƒ†å›ºé†‡ã€è¡€ç³–
- å¸çƒŸã€é¥®é…’ã€è¿åŠ¨

**è®¿é—®**: http://localhost:5000/web/predict.html

### 2. æ•°æ®åˆ†ææŠ¥å‘Š ğŸ“Š

äº¤äº’å¼æ•°æ®å¯è§†åŒ–åˆ†æï¼ŒåŒ…å« 5 ç§ Plotly äº¤äº’å¼å›¾è¡¨ã€‚

**ç”ŸæˆæŠ¥å‘Š**:
```bash
generate_report.bat
```

**è®¿é—®**: http://localhost:5000/analysis/report.html

### 3. AI è¯­éŸ³é—®ç­” ğŸ™ï¸

åŸºäº DeepSeek å’Œ CosyVoice çš„æ™ºèƒ½è¯­éŸ³åŠ©æ‰‹ï¼Œæä¾›ä¸“ä¸šå¥åº·å’¨è¯¢ã€‚

**é…ç½® API Key** (åˆ›å»º `.env` æ–‡ä»¶):
```env
DEEPSEEK_API_KEY=your_deepseek_api_key
COSYVOICE_APPKEY=your_cosyvoice_appkey
```

**è®¿é—®**: http://localhost:5000/web/qa_audio.html

---

## ğŸ”§ æŠ€æœ¯æ ˆ

### åç«¯
- Python 3.8+
- Flask 3.0.0
- XGBoost 2.0.3
- scikit-learn 1.3.2
- pandas 2.1.4

### AI æœåŠ¡
- DeepSeek API (LangChain)
- CosyVoice (DashScope SDK)

### å‰ç«¯
- HTML5 + CSS3 + JavaScript
- Plotly 5.18.0
- Axios

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
aicodes/
â”œâ”€â”€ analysis/              # æ•°æ®åˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ data_analysis.py
â”‚   â””â”€â”€ report.html       # ç”Ÿæˆçš„æŠ¥å‘Š
â”œâ”€â”€ model/                 # æœºå™¨å­¦ä¹ æ¨¡å‹
â”‚   â”œâ”€â”€ train_xgb.py      # æ¨¡å‹è®­ç»ƒ
â”‚   â”œâ”€â”€ xgb_model.pkl     # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â”œâ”€â”€ scaler.pkl        # æ ‡å‡†åŒ–å™¨
â”‚   â””â”€â”€ feature_names.pkl # ç‰¹å¾å
â”œâ”€â”€ audio/                 # è¯­éŸ³é—®ç­”æ¨¡å—
â”‚   â””â”€â”€ qa_audio.py       # æ ¸å¿ƒé—®ç­”
â”œâ”€â”€ api/                   # Flask API
â”‚   â””â”€â”€ predict_api.py    # API æ¥å£
â”œâ”€â”€ web/                   # å‰ç«¯é¡µé¢
â”‚   â”œâ”€â”€ home.html         # ç³»ç»Ÿé¦–é¡µ
â”‚   â”œâ”€â”€ predict.html      # é¢„æµ‹é¡µé¢
â”‚   â””â”€â”€ qa_audio.html     # é—®ç­”é¡µé¢
â”œâ”€â”€ utils/                 # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ audio_utils.py
â”‚   â”œâ”€â”€ logger.py
â”‚   â””â”€â”€ config.py
â”œâ”€â”€ static/                # é™æ€æ–‡ä»¶
â”‚   â””â”€â”€ audio/            # éŸ³é¢‘æ–‡ä»¶
â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ START.bat              # ä¸»å¯åŠ¨èœå•
â”œâ”€â”€ requirements.txt       # Python ä¾èµ–
â””â”€â”€ README.md             # æœ¬æ–‡æ¡£
```

---

## ğŸ¯ ä½¿ç”¨æµç¨‹

### å®Œæ•´æµç¨‹

1. **å®‰è£…ä¾èµ–** â†’ `install_dependencies.bat`
2. **ç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Š** â†’ `generate_report.bat`
3. **è®­ç»ƒæ¨¡å‹** â†’ `train_model_xgb.bat`
4. **å¯åŠ¨æœåŠ¡** â†’ `start_predict_server.bat`
5. **è®¿é—®é¦–é¡µ** â†’ http://localhost:5000/

### ä½¿ç”¨ä¸»èœå• (æ¨è)

```bash
START.bat
```

èœå•é€‰é¡¹:
- `1` - å®‰è£…ä¾èµ–åŒ…
- `2` - è®­ç»ƒ XGBoost æ¨¡å‹
- `3` - å¯åŠ¨é¢„æµ‹æœåŠ¡
- `4` - ç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Š
- `5` - å¯åŠ¨è¯­éŸ³é—®ç­”ç³»ç»Ÿ
- `6` - æµ‹è¯•è¯­éŸ³é—®ç­”
- `7` - æ£€æŸ¥ç¯å¢ƒ
- `0` - é€€å‡º

---

## ğŸ“Š API æ¥å£

### 1. ç–¾ç—…é¢„æµ‹

**POST** `/predict`

```json
// è¯·æ±‚
{
  "age": 50,
  "gender": 2,
  "height": 170,
  "weight": 70,
  "ap_hi": 120,
  "ap_lo": 80,
  "cholesterol": 1,
  "gluc": 1,
  "smoke": 0,
  "alco": 0,
  "active": 1
}

// å“åº”
{
  "success": true,
  "prediction": 0,
  "prediction_label": "å¥åº·",
  "probability": {
    "healthy": 0.85,
    "disease": 0.15
  },
  "risk_level": "ä½é£é™©"
}
```

### 2. è¯­éŸ³é—®ç­”

**POST** `/qa_audio`

```json
// è¯·æ±‚
{
  "question": "å¦‚ä½•é¢„é˜²å¿ƒè¡€ç®¡ç–¾ç—…ï¼Ÿ"
}

// å“åº”
{
  "success": true,
  "text": "é¢„é˜²å¿ƒè¡€ç®¡ç–¾ç—…çš„å…³é”®æªæ–½åŒ…æ‹¬...",
  "audio_url": "/static/audio/abc123.wav"
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: é¢„æµ‹å¤±è´¥ï¼Œæç¤º"æ¨¡å‹æœªåŠ è½½"ï¼Ÿ
**A**: å…ˆè¿è¡Œ `train_model_xgb.bat` è®­ç»ƒæ¨¡å‹ã€‚

### Q2: è¯­éŸ³é—®ç­”æ— æ³•ä½¿ç”¨ï¼Ÿ
**A**: éœ€è¦é…ç½® `.env` æ–‡ä»¶ä¸­çš„ DeepSeek å’Œ CosyVoice API Keyã€‚

### Q3: å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ï¼Ÿ
**A**: æŸ¥çœ‹ `logs/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶ï¼š
- `logs/api.log` - API æœåŠ¡æ—¥å¿—
- `logs/audio.log` - è¯­éŸ³é—®ç­”æ—¥å¿—
- `logs/analysis.log` - æ•°æ®åˆ†ææ—¥å¿—

### Q4: æ•°æ®åˆ†ææŠ¥å‘Šæ— æ³•è®¿é—®ï¼Ÿ
**A**: å…ˆè¿è¡Œ `generate_report.bat` ç”ŸæˆæŠ¥å‘Šã€‚

---

## ğŸ“ ç¯å¢ƒé…ç½®

### Python ç¯å¢ƒ

æœ¬é¡¹ç›®ä½¿ç”¨ Anaconda ç¯å¢ƒï¼š
```
D:\software\Anaconda\envs\cardioenv\python.exe
```

### ä¾èµ–åŒ…

ä¸»è¦ä¾èµ–ï¼ˆè¯¦è§ `requirements.txt`ï¼‰:
- Flask 3.0.0
- XGBoost 2.0.3
- scikit-learn 1.3.2
- pandas 2.1.4
- plotly 5.18.0
- langchain-openai 0.1.0
- dashscope 1.14.0

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æ¨¡å— | å¤„ç†æ—¶é—´ | å‡†ç¡®ç‡ |
|-----|---------|--------|
| æ•°æ®åˆ†æ | < 10 ç§’ | - |
| æ¨¡å‹è®­ç»ƒ | 1-3 åˆ†é’Ÿ | - |
| ç–¾ç—…é¢„æµ‹ | < 100 ms | 70-75% |
| æ–‡æœ¬ç”Ÿæˆ | 2-5 ç§’ | - |
| è¯­éŸ³åˆæˆ | 1-3 ç§’ | - |

---

## ğŸ‰ æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¿ƒè¡€ç®¡ç–¾ç—…é¢„æµ‹ç³»ç»Ÿï¼ŒåŒ…å«ï¼š

âœ… **æ•°æ®åˆ†æ** - äº¤äº’å¼å¯è§†åŒ–æŠ¥å‘Š  
âœ… **æœºå™¨å­¦ä¹ ** - XGBoost é£é™©é¢„æµ‹  
âœ… **AI é—®ç­”** - DeepSeek + CosyVoice è¯­éŸ³åŠ©æ‰‹

**ç«‹å³å¼€å§‹**: è¿è¡Œ `START.bat` ğŸš€

---

Â© 2025 å¿ƒè¡€ç®¡ç–¾ç—…é¢„æµ‹ç³»ç»Ÿ | Powered by XGBoost + DeepSeek + CosyVoice
